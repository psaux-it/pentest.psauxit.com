#!/bin/bash
# Helper script for pentest.psauxit.com

if [[ $1 == dig ]]; then
  if [[ $# -eq 2 ]]; then
    dig $2 any
  elif [[ $3 == DMARC ]]; then
    dig TXT _dmarc.$4
  elif [[ $3 == SPF ]]; then
    dig TXT $4
  elif [[ $3 == MX ]]; then
    dig MX $4
  elif [[ $3 == NS ]]; then
    dig NS $4
  elif [[ $3 == A ]]; then
    dig A $4
  elif [[ $3 == REVERSE ]]; then
    dig -x $(dig A $4 | grep -v -e "^$\|^;" | awk '{print $NF}') | grep -v -e "^$\|^;" | awk '{print $5}' | sed 's/.$//'
  fi
elif [[ $1 == dnsrecon ]]; then
  if [[ $# -eq 2 ]]; then
    dnsrecon.py -d $2
  elif [[ $3 == AXFR ]]; then
    dnsrecon.py -d $4 -t zonewalk
  elif [[ $3 == ZONEWALK ]]; then
    dnsrecon.py -d $4 -t axfr
  elif [[ $3 == BRUTE ]]; then  
    dnsrecon.py -d $4 -D /dnsrecon/subdomains-top1mil-20000.txt -t brt
  fi
fi
