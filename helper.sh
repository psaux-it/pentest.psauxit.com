#!/bin/bash
# Helper script for pentest.psauxit.com

if [[ $1 == dig ]]; then
  if [[ $# -eq 2 ]]; then
    dig ${@: -1} any
  elif [[ $3 == DMARC ]]; then
    dig TXT _dmarc.${@: -1}
  elif [[ $3 == SPF ]]; then
    dig TXT ${@: -1}
  elif [[ $3 == MX ]]; then
    dig MX ${@: -1}
  elif [[ $3 == NS ]]; then
    dig NS ${@: -1}
  elif [[ $3 == A ]]; then
    dig A ${@: -1}
  elif [[ $3 == REVERSE ]]; then
    dig -x $(dig A ${@: -1} | grep -v -e "^$\|^;" | awk '{print $NF}') | grep -v -e "^$\|^;" | awk '{print $5}' | sed 's/.$//'
  fi
elif [[ $1 == dnsrecon ]]; then
  if [[ $# -eq 2 ]]; then
    dnsrecon.py -d ${@: -1}
  elif [[ $3 == AXFR ]]; then
    dnsrecon.py -d ${@: -1} -t zonewalk
  elif [[ $3 == ZONEWALK ]]; then
    dnsrecon.py -d ${@: -1} -t axfr
  elif [[ $3 == BRUTE ]]; then  
    dnsrecon.py -d ${@: -1} -D /dnsrecon/subdomains-top1mil-20000.txt -t brt
  fi
elif [[ $1 == wpscan ]]; then
  args=("$@")
  for n in "${!args[@]}"; do
    if [[ ${args[n]} == timeout ]] && opt_1="--connect-timeout ${args[n+1]}"
    if [[ ${args[n]} == request ]] && opt_2="--request-timeout ${args[n+1]}"
    if [[ ${args[n]} == DISABLE ]] && opt_3="--disable-tls-checks"
  done
   
  for i in $@; do
    if [[ $i == MIXED ]]; then
      wpscan --url ${@: -1} --detection-mode mixed $opt_1 $opt_2 $opt_3
    elif [[ $i == PASSIVE ]]; then
      wpscan --url ${@: -1} --detection-mode passive $opt_1 $opt_2 $opt_3
    elif [[ $i == AGGRESSIVE ]]; then
      wpscan --url ${@: -1} --detection-mode aggressive $opt_1 $opt_2 $opt_3
    fi
  done
fi
